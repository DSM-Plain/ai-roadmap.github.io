---
layout: post
title: "PR 리뷰 (Pull Request Review)"
date: 2025-12-09
categories: [Github]
---

## 개요

코드 리뷰는 코드 품질을 높이고 팀의 지식을 공유하는 핵심 프로세스이다. 이 문서에서는 효과적인 PR 리뷰 방법을 알아볼 것이다.

## 왜 코드 리뷰를 하나?

### 코드 품질 향상
- 버그와 에러 사전 발견
- 성능 이슈 파악
- 보안 취약점 점검
- 코드 스타일 일관성 유지

### 지식 공유
- 팀원들이 코드베이스 이해
- 새로운 기술과 패턴 학습
- 도메인 지식 전파
- 멘토링 기회

### 협업 문화
- 팀워크 강화
- 상호 신뢰 구축
- 의사소통 개선
- 집단 코드 소유권

## PR 리뷰 역할

### 작성자 (Author)
**책임:**
- 리뷰하기 쉬운 PR 작성
- 충분한 컨텍스트 제공
- 피드백에 열린 자세
- 변경사항 명확히 설명

**체크리스트:**
```markdown
작성 전:
- [ ] 셀프 리뷰 완료
- [ ] 테스트 작성 및 통과
- [ ] 린팅/포맷팅 적용
- [ ] 불필요한 변경사항 제거
- [ ] 커밋 메시지 정리

작성 시:
- [ ] 명확한 제목
- [ ] 상세한 설명
- [ ] 스크린샷/영상 첨부 (UI 변경 시)
- [ ] 테스트 방법 명시
- [ ] 관련 이슈 링크
```

### 리뷰어 (Reviewer)
**책임:**
- 코드 품질 검증
- 건설적인 피드백 제공
- 빠른 응답
- 지식 공유

**체크리스트:**
```markdown
기능:
- [ ] 요구사항을 충족하는가?
- [ ] 엣지 케이스를 고려했는가?
- [ ] 에러 처리가 적절한가?

코드 품질:
- [ ] 읽기 쉽고 이해하기 쉬운가?
- [ ] 중복 코드는 없는가?
- [ ] 네이밍이 명확한가?
- [ ] 함수/클래스 크기가 적절한가?

성능:
- [ ] 불필요한 연산은 없는가?
- [ ] 메모리 누수 가능성은?
- [ ] 데이터베이스 쿼리 최적화는?

보안:
- [ ] 입력 검증을 하는가?
- [ ] 인증/인가가 적절한가?
- [ ] 민감 정보 노출은 없는가?
- [ ] SQL 인젝션 등 취약점은?

테스트:
- [ ] 충분한 테스트가 있는가?
- [ ] 테스트가 의미 있는가?
- [ ] 모든 테스트가 통과하는가?

문서:
- [ ] 주석이 필요한 곳에 있는가?
- [ ] README 업데이트가 필요한가?
- [ ] API 문서 변경이 필요한가?
```

## 좋은 PR 작성하기

### 작은 PR
```
❌ 나쁜 예:
PR #123: "리팩토링 및 새 기능들"
- 50개 파일 변경
- 3,000줄 추가
- 여러 기능 동시 구현

✅ 좋은 예:
PR #123: "사용자 인증 API 추가"
- 5개 파일 변경
- 200줄 추가
- 하나의 명확한 목적
```

### 명확한 설명
```markdown
## 변경 사항
JWT 기반 사용자 인증 시스템을 구현했습니다.

## 상세 내용
- `/api/auth/login` 엔드포인트 추가
- `/api/auth/register` 엔드포인트 추가
- JWT 토큰 생성 및 검증 미들웨어
- 비밀번호 해싱 (bcrypt)

## 테스트 방법
```bash
# 회원가입
curl -X POST http://localhost:3000/api/auth/register \
  -d '{"email":"test@example.com","password":"secret123"}'

# 로그인
curl -X POST http://localhost:3000/api/auth/login \
  -d '{"email":"test@example.com","password":"secret123"}'
```

## 스크린샷
![로그인 화면](screenshot.png)

## 체크리스트
- [x] 단위 테스트 추가
- [x] 통합 테스트 추가
- [x] API 문서 업데이트
- [x] 에러 처리 구현

## 관련 이슈
Closes #456
Related to #123
```

## 효과적인 리뷰 코멘트

### 구체적이고 명확하게
```markdown
❌ 나쁜 예:
"이 부분이 이상해요."

✅ 좋은 예:
"이 함수에서 `user`가 null일 때를 처리하지 않았습니다.
user가 없을 경우 에러가 발생할 수 있습니다.

제안:
```javascript
if (!user) {
  throw new Error('User not found');
}
```
```

### 이유 설명하기
```markdown
❌ 나쁜 예:
"이렇게 바꾸세요."

✅ 좋은 예:
"현재 방식은 매번 데이터베이스를 조회하여 성능 이슈가 있을 수 있습니다.
캐싱을 활용하면 응답 속도를 크게 개선할 수 있습니다.

예시:
```javascript
const cachedUser = cache.get(`user:${userId}`);
if (cachedUser) return cachedUser;
```
```

### 질문으로 시작하기
```markdown
❌ "이건 틀렸어요."

✅ "이 접근 방식을 선택한 특별한 이유가 있나요?
   대안으로 X 방법도 고려해볼 수 있을 것 같은데 의견이 어떠신가요?"
```

### 긍정적 피드백도 주기
```markdown
✅ "예외 처리 로직이 깔끔하네요! 👍"
✅ "이 헬퍼 함수 추가로 코드가 훨씬 읽기 쉬워졌습니다."
✅ "테스트 커버리지가 훌륭합니다!"
```

## 리뷰 프로세스

### 1. 첫 번째 패스: 전체 흐름 파악
```
1. PR 설명 읽기
2. Files changed 탭에서 전체 변경사항 훑어보기
3. 변경의 의도와 범위 이해
4. 큰 그림에서 문제점 파악
```

### 2. 두 번째 패스: 상세 리뷰
```
1. 파일별로 꼼꼼히 검토
2. 로직 검증
3. 엣지 케이스 확인
4. 코드 품질 체크
5. 인라인 코멘트 작성
```

### 3. 세 번째 패스: 테스트 및 실행
```
1. 로컬에서 브랜치 체크아웃
2. 빌드 및 테스트 실행
3. 직접 기능 동작 확인
4. 성능 측정 (필요시)
```

### 4. 리뷰 제출
```
Comment: 일반 의견
Approve: 승인
Request changes: 수정 요청
```

## 리뷰 타입별 전략

### 긴급 Hotfix
```
우선순위: 속도
- 핵심 로직만 빠르게 검토
- 버그 수정이 정확한지 확인
- 사이드 이펙트 체크
- 빠른 승인 및 배포
```

### 리팩토링
```
우선순위: 품질
- 기능 동작이 동일한지 확인
- 테스트 커버리지 유지
- 코드 가독성 개선 확인
- 불필요한 변경 없는지 체크
```

### 새 기능
```
우선순위: 균형
- 요구사항 충족 확인
- 확장성 고려
- 테스트 충분성
- 문서화 여부
```

## Github 리뷰 기능 활용

### 인라인 코멘트
```javascript
// 특정 라인에 코멘트
function calculateTotal(items) {
  // 💬 "items가 빈 배열일 때 처리가 필요합니다"
  return items.reduce((sum, item) => sum + item.price, 0);
}
```

### 제안 (Suggestions)
```diff
- const result = array.map(x => x * 2).filter(x => x > 10);
+ const result = array
+   .map(x => x * 2)
+   .filter(x => x > 10);
```
→ "Commit suggestion" 버튼으로 바로 적용 가능

### 리뷰 코멘트 해결
```
Conversation tab:
☑️ Resolve conversation
→ 이슈 해결 시 체크
```

### 리뷰 상태
```
✅ Approved (승인)
💬 Commented (코멘트만)
❌ Changes requested (수정 요청)
👀 Review required (리뷰 필요)
```

## 코드 리뷰 안티패턴

### 피해야 할 것들

#### 1. 니트픽킹 (Nitpicking)
```markdown
❌ "여기 세미콜론이 빠졌어요"
❌ "변수명을 userData가 아니라 userInfo로 하는 게 어떨까요?"

→ 이런 것들은 린터/포맷터로 자동화
```

#### 2. 방어적 태도
```markdown
작성자 ❌:
"이게 맞는데요. 원래 이렇게 하는 거예요."

작성자 ✅:
"그 부분은 X 이유로 이렇게 구현했습니다.
 제안해주신 Y 방식도 좋은데, 차이점은...?"
```

#### 3. 늦은 리뷰
```
PR 생성: 월요일 오전
리뷰: 금요일 오후 ❌

→ 24시간 내 리뷰 목표
→ 빠른 피드백 사이클
```

#### 4. 승인 후 코멘트
```
❌ Approve 클릭 → 나중에 "아 이 부분 문제 있네요"

✅ 모든 리뷰 완료 후 최종 판단
```

#### 5. 일방적 강요
```markdown
❌ "무조건 이렇게 바꾸세요."

✅ "이런 방법도 고려해보시겠어요?
   각각의 장단점은..."
```

## 자동화로 리뷰 효율화

### CI/CD 체크
```yaml
# .github/workflows/pr-checks.yml
name: PR Checks
on: [pull_request]

jobs:
  lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - run: npm run lint

  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - run: npm test

  coverage:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - run: npm run coverage
      - name: Coverage check
        run: |
          if [ $(coverage) -lt 80 ]; then
            exit 1
          fi
```

### 자동 코드 리뷰 봇
```yaml
# .github/workflows/auto-review.yml
- name: Code Review
  uses: reviewdog/action-eslint@v1
  with:
    reporter: github-pr-review
    eslint_flags: 'src/**/*.js'
```

### Danger.js
```javascript
// dangerfile.js
import { danger, warn, fail } from 'danger';

// PR 크기 체크
const bigPRThreshold = 500;
if (danger.github.pr.additions > bigPRThreshold) {
  warn(`PR이 큽니다 (${danger.github.pr.additions}줄).
        분리를 고려해주세요.`);
}

// 테스트 파일 체크
const hasTestChanges = danger.git.modified_files
  .some(f => f.includes('test'));

if (!hasTestChanges) {
  warn('테스트 파일 변경이 없습니다.');
}

// CHANGELOG 업데이트 체크
const hasChangelog = danger.git.modified_files
  .includes('CHANGELOG.md');

if (!hasChangelog) {
  fail('CHANGELOG.md를 업데이트해주세요.');
}
```

## 리뷰 문화 만들기

### 팀 가이드라인
```markdown
# 우리 팀의 코드 리뷰 원칙

1. 24시간 내 리뷰 응답
2. 긍정적이고 건설적인 피드백
3. "why"를 설명하기
4. 작은 PR 권장 (300줄 이하)
5. 최소 1명의 승인 필요
6. 모든 코멘트 해결 후 머지
```

### 리뷰 회고
```markdown
# 스프린트 회고에서

잘된 점:
- 리뷰 응답 시간이 개선됨
- 보안 취약점 사전 발견

개선할 점:
- 니트픽킹 줄이기
- 더 구체적인 피드백

액션 아이템:
- 린터 설정 강화
- 리뷰 체크리스트 템플릿 작성
```

## 리뷰 메트릭

### 추적할 지표
```
- 평균 리뷰 응답 시간
- PR당 코멘트 수
- 승인까지 걸린 시간
- 머지 후 발견된 버그
- 리뷰 참여율
```

### Github Insights 활용
```
Insights → Pull requests
- 평균 머지 시간
- 활발한 리뷰어
- PR 크기 분포
```

## 고급 리뷰 테크닉

### 체크아웃해서 직접 실행
```bash
# PR 브랜치 로컬에서 테스트
gh pr checkout 123

# 또는
git fetch origin pull/123/head:pr-123
git checkout pr-123

# 실행 및 테스트
npm install
npm test
npm start
```

### 변경사항 비교
```bash
# 베이스 브랜치와 비교
git diff main...feature-branch

# 특정 파일만
git diff main...feature-branch -- src/auth.js

# 통계 보기
git diff --stat main...feature-branch
```

### 코드 소유권 확인
```bash
# 파일 변경 이력 확인
git log -p -- src/auth.js

# 각 라인의 작성자
git blame src/auth.js
```

## 결론

효과적인 코드 리뷰의 핵심:

**작성자:**
- 작고 명확한 PR
- 충분한 컨텍스트 제공
- 열린 자세

**리뷰어:**
- 빠른 응답
- 건설적인 피드백
- 지식 공유

**팀:**
- 명확한 가이드라인
- 긍정적인 문화
- 지속적인 개선

좋은 코드 리뷰는 더 나은 코드와 더 강한 팀을 만든다.
